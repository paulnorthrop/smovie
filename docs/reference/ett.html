<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extremal Types Theorem (ETT) — ett • smovie</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extremal Types Theorem (ETT) — ett"><meta name="description" content="A movie to illustrate the extremal types theorem, that is, convergence
of the distribution of the maximum of a random sample of size \(n\)
from certain distributions to a member of the Generalized Extreme Value
(GEV) family, as \(n\) tends to infinity.
Samples of size \(n\) are simulated repeatedly from the chosen
distribution.  The distributions (simulated empirical and true) of the
sample maxima are compared to the relevant GEV limit."><meta property="og:description" content="A movie to illustrate the extremal types theorem, that is, convergence
of the distribution of the maximum of a random sample of size \(n\)
from certain distributions to a member of the Generalized Extreme Value
(GEV) family, as \(n\) tends to infinity.
Samples of size \(n\) are simulated repeatedly from the chosen
distribution.  The distributions (simulated empirical and true) of the
sample maxima are compared to the relevant GEV limit."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">smovie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/smovie-vignette.html">An overview of smovie</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/smovie/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extremal Types Theorem (ETT)</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/smovie/blob/HEAD/R/extremal_types_theorem.R"><code>R/extremal_types_theorem.R</code></a></small>
      <div class="d-none name"><code>ett.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A movie to illustrate the extremal types theorem, that is, convergence
of the distribution of the maximum of a random sample of size \(n\)
from certain distributions to a member of the Generalized Extreme Value
(GEV) family, as \(n\) tends to infinity.
Samples of size \(n\) are simulated repeatedly from the chosen
distribution.  The distributions (simulated empirical and true) of the
sample maxima are compared to the relevant GEV limit.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ett</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="va">distn</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  panel_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hscale <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  vscale <span class="op">=</span> <span class="va">hscale</span>,</span>
<span>  n_add <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  delta_n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  leg_cex <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>An integer scalar.  The size of the samples drawn from the
distribution chosen using <code>distn</code>.  <code>n</code> must be no smaller
than 2.</p></dd>


<dt id="arg-distn">distn<a class="anchor" aria-label="anchor" href="#arg-distn"></a></dt>
<dd><p>A character scalar specifying the distribution from which
  observations are sampled.   Distributions <code>"beta"</code>,
  <code>"cauchy"</code>, <code>"chisq"</code>, <code>"chi-squared"</code>,
  <code>"exponential"</code>, <code>"f"</code>, <code>"gamma"</code>, <code>"gp"</code>,
  <code>"lognormal"</code>, <code>"log-normal"</code>,  <code>"ngev"</code>, <code>"normal"</code>,
  <code>"t"</code>, <code>"uniform"</code> and <code>"weibull"</code> are recognised, case
  being ignored.</p>
<p>If <code>distn</code> is not supplied then <code>distn = "exponential"</code>
  is used.</p>
<p>The <code>"gp"</code> case uses the <code><a href="https://paulnorthrop.github.io/revdbayes/reference/gp.html" class="external-link">gp</a></code>
  distributional functions in the
  <code><a href="https://paulnorthrop.github.io/revdbayes/reference/revdbayes-package.html" class="external-link">revdbayes</a></code> package.</p>
<p>The <code>"ngev"</code> case is a negated GEV(1 / \(\xi\), 1, \(\xi\))
  distribution, for \(\xi\) &gt; 0, and uses the <code><a href="https://paulnorthrop.github.io/revdbayes/reference/gev.html" class="external-link">gev</a></code>
  distributional functions in the
  <code><a href="https://paulnorthrop.github.io/revdbayes/reference/revdbayes-package.html" class="external-link">revdbayes</a></code> package.
  If \(\xi\) = 1 then this coincides with Example 1.7.5 in Leadbetter,
  Lindgren and Rootzen (1983).</p>
<p>The other cases use the distributional functions in the
  <code><a href="https://rdrr.io/r/stats/stats-package.html" class="external-link">stats-package</a></code>.
  If <code>distn = "gamma"</code> then the <code>(shape, rate)</code>
  parameterisation is used.  If <code>scale</code> is supplied via <code>params</code>
  then <code>rate</code> is inferred from this.
  If <code>distn = "beta"</code> then <code>ncp</code> is forced to be zero.</p></dd>


<dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>A named list of additional arguments to be passed to the
  density function associated with distribution <code>distn</code>.
  The <code>(shape, rate)</code> parameterisation is used for the gamma
  distribution (see <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">GammaDist</a></code>) even if the value of
  the <code>scale</code> parameter is set using <code>params</code>.</p>
<p>If a parameter value is not supplied then the default values in the
  relevant distributional function set using <code>distn</code> are used,
  except for
  <code>"beta"</code> (<code>shape1 = 2, shape2 = 2</code>),
  <code>"chisq"</code> (<code>df = 4</code>),
  <code>"f"</code> (<code>df1 = 4, df2 = 8</code>),
  <code>"ngev"</code> (<code>shape = 0.2</code>).
  <code>"gamma"</code> (<code>shape = 2</code>,
  <code>"gp"</code> (<code>shape = 0.1</code>),
  <code>"t"</code> (<code>df = 4</code>) and
  <code>"weibull"</code> (<code>shape = 2</code>).</p></dd>


<dt id="arg-panel-plot">panel_plot<a class="anchor" aria-label="anchor" href="#arg-panel-plot"></a></dt>
<dd><p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p></dd>


<dt id="arg-hscale-vscale">hscale, vscale<a class="anchor" aria-label="anchor" href="#arg-hscale-vscale"></a></dt>
<dd><p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p></dd>


<dt id="arg-n-add">n_add<a class="anchor" aria-label="anchor" href="#arg-n-add"></a></dt>
<dd><p>An integer scalar.  The number of simulated datasets to add
to each new frame of the movie.</p></dd>


<dt id="arg-delta-n">delta_n<a class="anchor" aria-label="anchor" href="#arg-delta-n"></a></dt>
<dd><p>A numeric scalar.  The amount by which n is increased
(or decreased) after one click of the + (or -) button in the parameter
window.</p></dd>


<dt id="arg-arrow">arrow<a class="anchor" aria-label="anchor" href="#arg-arrow"></a></dt>
<dd><p>A logical scalar.  Should an arrow be included to show the
simulated sample maximum from the top plot being placed into the
bottom plot?</p></dd>


<dt id="arg-leg-cex">leg_cex<a class="anchor" aria-label="anchor" href="#arg-leg-cex"></a></dt>
<dd><p>The argument <code>cex</code> to <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></code>.
Allows the size of the legend to be controlled manually.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to the rpanel functions
<code><a href="https://rdrr.io/pkg/rpanel/man/rp.button.html" class="external-link">rp.button</a></code> and
<code><a href="https://rdrr.io/pkg/rpanel/man/rp.doublebutton.html" class="external-link">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Nothing is returned, only the animation is produced.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Loosely speaking, a consequence of the
  <a href="https://en.wikipedia.org/wiki/Extreme_value_theory#Univariate_theory" class="external-link">Extremal Types Theorem</a>
  is that, in many situations, the maximum of a <em>large number</em>
  \(n\) of independent random variables has <em>approximately</em> a
  GEV(\(\mu, \sigma, \xi)\)) distribution, where \(\mu\) is a location
  parameter, \(\sigma\) is a scale parameter and \(\xi\) is a shape
  parameter.  See Coles (2001) for an introductory account and
  Leadbetter et al (1983) for greater detail and more examples.
  The Extremal Types Theorem is an asymptotic result that considers the
  possible limiting distribution of linearly normalised maxima
  as \(n\) tends to infinity.
  This movie considers examples where this limiting result holds and
  illustrates graphically the closeness of the limiting approximation
  provided by the relevant GEV limit to the true finite-\(n\)
  distribution.</p>
<p>Samples of size <code>n</code> are repeatedly simulated from the distribution
  chosen using <code>distn</code>.  These samples are summarized using a histogram
  that appears at the top of the movie screen.  For each sample the maximum
  of these <code>n</code> values is calculated, stored and added to another plot,
  situated below the first plot.
  A <code><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></code> is added to a histogram provided that it
  contains no more than 1000 points.
  This plot is either a histogram or an empirical c.d.f., chosen using a
  radio button.</p>
<p>The probability density function (p.d.f.) of the original
  variables is superimposed on the top histogram.
  There is a checkbox to add to the bottom plot the exact p.d.f./c.d.f. of
  the sample maxima and an approximate (large <code>n</code>) GEV p.d.f./c.d.f.
  implied by the ETT.
  The GEV shape parameter \(\xi\) that applies in the limiting
  case is used.  The GEV location \(\mu\) and scale
  \(\sigma\) are set based on constants used to normalise the maxima
  to achieve the GEV limit.
  Specifically, \(\mu\) is set at the 100(1-1/\(n\))% quantile of the
  distribution <code>distn</code> and \(\sigma\) at
  (1 / \(n\)) / \(f(\mu)\), where \(f\) is the
  density function of the distribution <code>distn</code>.</p>
<p>Once it starts, four aspects of this movie are controlled by the user.</p><ul><li><p>There are buttons to increase (+) or decrease (-) the sample
      size, that is, the number of values over which a maximum is
      calculated.</p></li>
<li><p>Each time the button labelled "simulate another <code>n_add</code>
      samples of size n" is clicked <code>n_add</code> new samples are simulated
      and their sample maxima are added to the bottom histogram.</p></li>
<li><p>There is a button to switch the bottom plot from displaying
      a histogram of the simulated maxima, the exact p.d.f. and the
      limiting GEV p.d.f. to the empirical c.d.f. of the simulated data,
      the exact c.d.f. and the limiting GEV c.d.f.</p></li>
<li><p>There is a box that can be used to display only the bottom
      plot.  This option is selected automatically if the sample size
      \(n\) exceeds 100000.</p></li>
<li><p>There is a box that can be used to display only the bottom
      plot.  This option is selected automatically if the sample size
      \(n\) exceeds 100000.</p></li>
</ul><p>For further detail about the examples specified by <code>distn</code>
  see Chapter 1 of Leadbetter et al. (1983) and Chapter 3 of
  Coles (2001).  In many of these examples
  (<code>"exponential"</code>, <code>"normal"</code>, <code>"gamma"</code>,
  <code>"lognormal"</code>, <code>"chi-squared"</code>, <code>"weibull"</code>, <code>"ngev"</code>)
  the limiting GEV distribution has a shape
  parameter that is equal to 0.  In the <code>"uniform"</code> case the limiting
  shape parameter is -1 and in the <code>"beta"</code> case it is
  -1 / <code>shape2</code>, where <code>shape2</code> is the
  second parameter of the <code><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">Beta</a></code> distribution.
  In the other cases the limiting shape parameter is positive,
  with respective values <code>shape</code>
  (<code>"gp"</code>, see <code><a href="https://paulnorthrop.github.io/revdbayes/reference/gp.html" class="external-link">gp</a></code>),
  1 / <code>df</code> (<code>"t"</code>, see <code><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">TDist</a></code>),
  1 (<code>"cauchy"</code>, see <code><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">Cauchy</a></code>),
  2 / <code>df2</code> (<code>"f"</code>, see <code><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">FDist</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  <a href="https://doi.org/10.1007/978-1-4471-3675-0_3" class="external-link">doi:10.1007/978-1-4471-3675-0_3</a></p>
<p>Leadbetter, M., Lindgren, G. and Rootzen, H. (1983)
  <em>Extremes and Related Properties of Random Sequences and Processes.</em>
  Springer-Verlag, New York.
  <a href="https://doi.org/10.1007/978-1-4612-5449-2" class="external-link">doi:10.1007/978-1-4612-5449-2</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="movies.html">movies</a></code>: a user-friendly menu panel.</p>
<p><code><a href="smovie-package.html">smovie</a></code>: general information about smovie.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Exponential data: xi = 0</span></span></span>
<span class="r-in"><span><span class="fu">ett</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Uniform data: xi =-1</span></span></span>
<span class="r-in"><span><span class="fu">ett</span><span class="op">(</span>distn <span class="op">=</span> <span class="st">"uniform"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Student t data: xi = 1 / df</span></span></span>
<span class="r-in"><span><span class="fu">ett</span><span class="op">(</span>distn <span class="op">=</span> <span class="st">"t"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

