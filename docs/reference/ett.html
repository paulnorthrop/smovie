<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extremal Types Theorem (ETT) — ett • smovie</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extremal Types Theorem (ETT) — ett"><meta property="og:description" content="A movie to illustrate the extremal types theorem, that is, convergence
of the distribution of the maximum of a random sample of size \(n\)
from certain distributions to a member of the Generalized Extreme Value
(GEV) family, as \(n\) tends to infinity.
Samples of size \(n\) are simulated repeatedly from the chosen
distribution.  The distributions (simulated empirical and true) of the
sample maxima are compared to the relevant GEV limit."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smovie</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/smovie-vignette.html">An overview of smovie</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/smovie/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extremal Types Theorem (ETT)</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/smovie/blob/HEAD/R/extremal_types_theorem.R" class="external-link"><code>R/extremal_types_theorem.R</code></a></small>
    <div class="hidden name"><code>ett.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A movie to illustrate the extremal types theorem, that is, convergence
of the distribution of the maximum of a random sample of size \(n\)
from certain distributions to a member of the Generalized Extreme Value
(GEV) family, as \(n\) tends to infinity.
Samples of size \(n\) are simulated repeatedly from the chosen
distribution.  The distributions (simulated empirical and true) of the
sample maxima are compared to the relevant GEV limit.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ett</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="va">distn</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  panel_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hscale <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  vscale <span class="op">=</span> <span class="va">hscale</span>,</span>
<span>  n_add <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  delta_n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  leg_cex <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>An integer scalar.  The size of the samples drawn from the
distribution chosen using <code>distn</code>.  <code>n</code> must be no smaller
than 2.</p></dd>


<dt>distn</dt>
<dd><p>A character scalar specifying the distribution from which
  observations are sampled.   Distributions <code>"beta"</code>,
  <code>"cauchy"</code>, <code>"chisq"</code>, <code>"chi-squared"</code>,
  <code>"exponential"</code>, <code>"f"</code>, <code>"gamma"</code>, <code>"gp"</code>,
  <code>"lognormal"</code>, <code>"log-normal"</code>,  <code>"ngev"</code>, <code>"normal"</code>,
  <code>"t"</code>, <code>"uniform"</code> and <code>"weibull"</code> are recognised, case
  being ignored.</p>
<p>If <code>distn</code> is not supplied then <code>distn = "exponential"</code>
  is used.</p>
<p>The <code>"gp"</code> case uses the <code><a href="https://paulnorthrop.github.io/revdbayes/reference/gp.html" class="external-link">gp</a></code>
  distributional functions in the
  <code><a href="https://paulnorthrop.github.io/revdbayes/reference/revdbayes.html" class="external-link">revdbayes</a></code> package.</p>
<p>The <code>"ngev"</code> case is a negated GEV(1 / \(\xi\), 1, \(\xi\))
  distribution, for \(\xi\) &gt; 0, and uses the <code><a href="https://paulnorthrop.github.io/revdbayes/reference/gev.html" class="external-link">gev</a></code>
  distributional functions in the
  <code><a href="https://paulnorthrop.github.io/revdbayes/reference/revdbayes.html" class="external-link">revdbayes</a></code> package.
  If \(\xi\) = 1 then this coincides with Example 1.7.5 in Leadbetter,
  Lindgren and Rootzen (1983).</p>
<p>The other cases use the distributional functions in the
  <code><a href="https://rdrr.io/r/stats/stats-package.html" class="external-link">stats-package</a></code>.
  If <code>distn = "gamma"</code> then the <code>(shape, rate)</code>
  parameterisation is used.  If <code>scale</code> is supplied via <code>params</code>
  then <code>rate</code> is inferred from this.
  If <code>distn = "beta"</code> then <code>ncp</code> is forced to be zero.</p></dd>


<dt>params</dt>
<dd><p>A named list of additional arguments to be passed to the
  density function associated with distribution <code>distn</code>.
  The <code>(shape, rate)</code> parameterisation is used for the gamma
  distribution (see <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">GammaDist</a></code>) even if the value of
  the <code>scale</code> parameter is set using <code>params</code>.</p>
<p>If a parameter value is not supplied then the default values in the
  relevant distributional function set using <code>distn</code> are used,
  except for
  <code>"beta"</code> (<code>shape1 = 2, shape2 = 2</code>),
  <code>"chisq"</code> (<code>df = 4</code>),
  <code>"f"</code> (<code>df1 = 4, df2 = 8</code>),
  <code>"ngev"</code> (<code>shape = 0.2</code>).
  <code>"gamma"</code> (<code>shape = 2</code>,
  <code>"gp"</code> (<code>shape = 0.1</code>),
  <code>"t"</code> (<code>df = 4</code>) and
  <code>"weibull"</code> (<code>shape = 2</code>).</p></dd>


<dt>panel_plot</dt>
<dd><p>A logical parameter that determines whether the plot
is placed inside the panel (<code>TRUE</code>) or in the standard graphics
window (<code>FALSE</code>).  If the plot is to be placed inside the panel
then the tkrplot library is required.</p></dd>


<dt>hscale, vscale</dt>
<dd><p>Numeric scalars.  Scaling parameters for the size
of the plot when <code>panel_plot = TRUE</code>. The default values are 1.4 on
Unix platforms and 2 on Windows platforms.</p></dd>


<dt>n_add</dt>
<dd><p>An integer scalar.  The number of simulated datasets to add
to each new frame of the movie.</p></dd>


<dt>delta_n</dt>
<dd><p>A numeric scalar.  The amount by which n is increased
(or decreased) after one click of the + (or -) button in the parameter
window.</p></dd>


<dt>arrow</dt>
<dd><p>A logical scalar.  Should an arrow be included to show the
simulated sample maximum from the top plot being placed into the
bottom plot?</p></dd>


<dt>leg_cex</dt>
<dd><p>The argument <code>cex</code> to <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></code>.
Allows the size of the legend to be controlled manually.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to the rpanel functions
<code><a href="https://rdrr.io/pkg/rpanel/man/rp.button.html" class="external-link">rp.button</a></code> and
<code><a href="https://rdrr.io/pkg/rpanel/man/rp.doublebutton.html" class="external-link">rp.doublebutton</a></code>, not including <code>panel</code>,
<code>variable</code>, <code>title</code>, <code>step</code>, <code>action</code>, <code>initval</code>,
<code>range</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Nothing is returned, only the animation is produced.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Loosely speaking, a consequence of the
  <a href="https://en.wikipedia.org/wiki/Extreme_value_theory#Univariate_theory" class="external-link">Extremal Types Theorem</a>
  is that, in many situations, the maximum of a <em>large number</em>
  \(n\) of independent random variables has <em>approximately</em> a
  GEV(\(\mu, \sigma, \xi)\)) distribution, where \(\mu\) is a location
  parameter, \(\sigma\) is a scale parameter and \(\xi\) is a shape
  parameter.  See Coles (2001) for an introductory account and
  Leadbetter et al (1983) for greater detail and more examples.
  The Extremal Types Theorem is an asymptotic result that considers the
  possible limiting distribution of linearly normalised maxima
  as \(n\) tends to infinity.
  This movie considers examples where this limiting result holds and
  illustrates graphically the closeness of the limiting approximation
  provided by the relevant GEV limit to the true finite-\(n\)
  distribution.</p>
<p>Samples of size <code>n</code> are repeatedly simulated from the distribution
  chosen using <code>distn</code>.  These samples are summarized using a histogram
  that appears at the top of the movie screen.  For each sample the maximum
  of these <code>n</code> values is calculated, stored and added to another plot,
  situated below the first plot.
  A <code><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></code> is added to a histogram provided that it
  contains no more than 1000 points.
  This plot is either a histogram or an empirical c.d.f., chosen using a
  radio button.</p>
<p>The probability density function (p.d.f.) of the original
  variables is superimposed on the top histogram.
  There is a checkbox to add to the bottom plot the exact p.d.f./c.d.f. of
  the sample maxima and an approximate (large <code>n</code>) GEV p.d.f./c.d.f.
  implied by the ETT.
  The GEV shape parameter \(\xi\) that applies in the limiting
  case is used.  The GEV location \(\mu\) and scale
  \(\sigma\) are set based on constants used to normalise the maxima
  to achieve the GEV limit.
  Specifically, \(\mu\) is set at the 100(1-1/\(n\))% quantile of the
  distribution <code>distn</code> and \(\sigma\) at
  (1 / \(n\)) / \(f(\mu)\), where \(f\) is the
  density function of the distribution <code>distn</code>.</p>
<p>Once it starts, four aspects of this movie are controlled by the user.</p><ul><li><p>There are buttons to increase (+) or decrease (-) the sample
      size, that is, the number of values over which a maximum is
      calculated.</p></li>
<li><p>Each time the button labelled "simulate another <code>n_add</code>
      samples of size n" is clicked <code>n_add</code> new samples are simulated
      and their sample maxima are added to the bottom histogram.</p></li>
<li><p>There is a button to switch the bottom plot from displaying
      a histogram of the simulated maxima, the exact p.d.f. and the
      limiting GEV p.d.f. to the empirical c.d.f. of the simulated data,
      the exact c.d.f. and the limiting GEV c.d.f.</p></li>
<li><p>There is a box that can be used to display only the bottom
      plot.  This option is selected automatically if the sample size
      \(n\) exceeds 100000.</p></li>
<li><p>There is a box that can be used to display only the bottom
      plot.  This option is selected automatically if the sample size
      \(n\) exceeds 100000.</p></li>
</ul><p>For further detail about the examples specified by <code>distn</code>
  see Chapter 1 of Leadbetter et al. (1983) and Chapter 3 of
  Coles (2001).  In many of these examples
  (<code>"exponential"</code>, <code>"normal"</code>, <code>"gamma"</code>,
  <code>"lognormal"</code>, <code>"chi-squared"</code>, <code>"weibull"</code>, <code>"ngev"</code>)
  the limiting GEV distribution has a shape
  parameter that is equal to 0.  In the <code>"uniform"</code> case the limiting
  shape parameter is -1 and in the <code>"beta"</code> case it is
  -1 / <code>shape2</code>, where <code>shape2</code> is the
  second parameter of the <code><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">Beta</a></code> distribution.
  In the other cases the limiting shape parameter is positive,
  with respective values <code>shape</code>
  (<code>"gp"</code>, see <code><a href="https://paulnorthrop.github.io/revdbayes/reference/gp.html" class="external-link">gp</a></code>),
  1 / <code>df</code> (<code>"t"</code>, see <code><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">TDist</a></code>),
  1 (<code>"cauchy"</code>, see <code><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">Cauchy</a></code>),
  2 / <code>df2</code> (<code>"f"</code>, see <code><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">FDist</a></code>).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  <a href="https://doi.org/10.1007/978-1-4471-3675-0_3" class="external-link">doi:10.1007/978-1-4471-3675-0_3</a></p>
<p>Leadbetter, M., Lindgren, G. and Rootzen, H. (1983)
  <em>Extremes and Related Properties of Random Sequences and Processes.</em>
  Springer-Verlag, New York.
  <a href="https://doi.org/10.1007/978-1-4612-5449-2" class="external-link">doi:10.1007/978-1-4612-5449-2</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="movies.html">movies</a></code>: a user-friendly menu panel.</p>
<p><code><a href="smovie.html">smovie</a></code>: general information about smovie.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Exponential data: xi = 0</span></span></span>
<span class="r-in"><span><span class="fu">ett</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>tkrplot is not available so panel_plot has been set to FALSE.</span>
<span class="r-plt img"><img src="ett-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Uniform data: xi =-1</span></span></span>
<span class="r-in"><span><span class="fu">ett</span><span class="op">(</span>distn <span class="op">=</span> <span class="st">"uniform"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>tkrplot is not available so panel_plot has been set to FALSE.</span>
<span class="r-plt img"><img src="ett-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Student t data: xi = 1 / df</span></span></span>
<span class="r-in"><span><span class="fu">ett</span><span class="op">(</span>distn <span class="op">=</span> <span class="st">"t"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>tkrplot is not available so panel_plot has been set to FALSE.</span>
<span class="r-plt img"><img src="ett-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

